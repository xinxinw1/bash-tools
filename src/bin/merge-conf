#!/usr/bin/bash

read -r -d '' help <<EOT
Usage: merge-conf <mine> <old> <yours>
Merge three files and output to <mine>
EOT

if [ -z "$1" ] || [ -z "$2" ] || [ -z "$3" ] || [ "$1" = "-h" ] || [ "$1" = "--help" ]; then
  echo "$help"
  exit
fi

"$(dirname "$0")/merge" "$1" "$2" "$3"
code="$?"

if [ "$code" == "0" ]; then
  mv "$3" "$2"
elif [ "$code" == "1" ]; then
  echo "Fix conflicts and then run $ mv \"$3\" \"$2\""
fi

exit "$code"

